{
  "schema": "watchtower/observation_set_v1",
  "type": "object",
  "required": ["schema_version","tenant_id","device_id","captured_at_utc","policy_ref","observations"],
  "properties": {
    "schema_version":{"type":"string","enum":["1"]},
    "tenant_id":{"type":"string"},
    "device_id":{"type":"string"},
    "captured_at_utc":{"type":"string"},
    "policy_ref":{"type":"object","required":["policy_id","policy_hash"],"properties":{"policy_id":{"type":"string"},"policy_hash":{"type":"string"}}},
    "observations":{
      "type":"object",
      "properties":{
        "boot":{"type":"object"},
        "storage":{"type":"object"},
        "software":{"type":"object"},
        "network":{"type":"object"},
        "security":{"type":"object"},
        "update_posture":{"type":"object"}
      }
    }
  }
}